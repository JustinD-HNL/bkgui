<!-- index.html - Complete Buildkite Pipeline Builder with All Features Merged -->
<!-- File: index.html -->
<!-- Path: / -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Buildkite Pipeline Builder - Enhanced v3.0</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- Main Application -->
    <div id="app-container" class="app-container">
        <!-- Header -->
        <header class="header">
            <div class="header-content">
                <div class="header-brand">
                    <i class="fas fa-stream"></i>
                    <h1>Buildkite Pipeline Builder</h1>
                    <span class="version">Enhanced v3.0</span>
                </div>
                <div class="header-actions">
                    <button id="theme-toggle" class="btn btn-secondary" title="Toggle Dark Mode">
                        <i class="fas fa-moon"></i>
                    </button>
                    <div id="api-status" class="api-status" title="Buildkite API Status">
                        <i class="fas fa-circle"></i>
                        <span>API</span>
                    </div>
                    <button id="api-config" class="btn btn-secondary" title="Configure Buildkite API">
                        <i class="fas fa-cog"></i>
                        API Config
                    </button>
                    <button id="load-example" class="btn btn-secondary">
                        <i class="fas fa-file-import"></i>
                        Load Example
                    </button>
                    <button id="load-saved-pipeline" class="btn btn-secondary" title="Load saved pipeline">
                        <i class="fas fa-folder-open"></i>
                        Load Saved
                    </button>
                    <button id="clear-pipeline" class="btn btn-secondary">
                        <i class="fas fa-trash"></i>
                        Clear All
                    </button>
                    <button id="share-pipeline" class="btn btn-secondary">
                        <i class="fas fa-share-alt"></i>
                        Share
                    </button>
                    <button id="export-yaml" class="btn btn-primary">
                        <i class="fas fa-download"></i>
                        Export YAML
                    </button>
                </div>
            </div>
        </header>

        <!-- Main Content - 3 Column Layout -->
        <main class="main-content">
            <!-- Enhanced Sidebar - Left Column -->
            <aside class="sidebar enhanced-sidebar">
                <div class="sidebar-header">
                    <h3><i class="fas fa-toolbox"></i> Step Types</h3>
                    <p>Drag steps to build your pipeline</p>
                </div>

                <!-- Core Steps -->
                <div class="step-category">
                    <h4><i class="fas fa-star"></i> Core Steps</h4>
                    <div class="step-palette">
                        <div class="step-type" draggable="true" data-step-type="command">
                            <i class="fas fa-terminal"></i>
                            <span>Command Step</span>
                            <small>Execute shell commands</small>
                        </div>
                        <div class="step-type" draggable="true" data-step-type="wait">
                            <i class="fas fa-hourglass-half"></i>
                            <span>Wait Step</span>
                            <small>Wait for previous steps</small>
                        </div>
                        <div class="step-type" draggable="true" data-step-type="block">
                            <i class="fas fa-hand-paper"></i>
                            <span>Block Step</span>
                            <small>Manual approval</small>
                        </div>
                        <div class="step-type" draggable="true" data-step-type="input">
                            <i class="fas fa-keyboard"></i>
                            <span>Input Step</span>
                            <small>Collect user input</small>
                        </div>
                    </div>
                </div>

                <!-- Advanced Steps -->
                <div class="step-category">
                    <h4><i class="fas fa-rocket"></i> Advanced Steps</h4>
                    <div class="step-palette">
                        <div class="step-type" draggable="true" data-step-type="trigger">
                            <i class="fas fa-bolt"></i>
                            <span>Trigger Step</span>
                            <small>Trigger another pipeline</small>
                        </div>
                        <div class="step-type" draggable="true" data-step-type="group">
                            <i class="fas fa-layer-group"></i>
                            <span>Group Step</span>
                            <small>Group related steps</small>
                        </div>
                        <div class="step-type" draggable="true" data-step-type="annotation">
                            <i class="fas fa-comment-alt"></i>
                            <span>Annotation</span>
                            <small>Add build annotations</small>
                        </div>
                        <div class="step-type" draggable="true" data-step-type="notify">
                            <i class="fas fa-bell"></i>
                            <span>Notify Step</span>
                            <small>Send notifications</small>
                        </div>
                        <div class="step-type" draggable="true" data-step-type="plugin">
                            <i class="fas fa-puzzle-piece"></i>
                            <span>Plugin Step</span>
                            <small>Use Buildkite plugins</small>
                        </div>
                        <div class="step-type" draggable="true" data-step-type="pipeline-upload">
                            <i class="fas fa-cloud-upload-alt"></i>
                            <span>Pipeline Upload</span>
                            <small>Dynamic pipeline upload</small>
                        </div>
                    </div>
                </div>

                <!-- Quick Actions -->
                <div class="sidebar-actions">
                    <h4><i class="fas fa-magic"></i> Quick Actions</h4>
                    <button id="plugin-catalog-btn" class="btn btn-secondary btn-block action-btn" data-action="plugin-catalog">
                        <i class="fas fa-store"></i> Plugin Catalog
                    </button>
                    <button id="matrix-builder-btn" class="btn btn-secondary btn-block action-btn" data-action="matrix-builder">
                        <i class="fas fa-th"></i> Matrix Builder
                    </button>
                    <button id="templates-btn" class="btn btn-secondary btn-block action-btn" data-action="step-templates">
                        <i class="fas fa-clipboard-list"></i> Step Templates
                    </button>
                    <button id="validate-pipeline-btn" class="btn btn-secondary btn-block action-btn" data-action="pipeline-validator">
                        <i class="fas fa-check-circle"></i> Validate Pipeline
                    </button>
                    <button class="btn btn-secondary btn-block action-btn" data-action="conditional-logic">
                        <i class="fas fa-code-branch"></i> Conditional Logic
                    </button>
                    <button class="btn btn-secondary btn-block action-btn" data-action="variable-manager">
                        <i class="fas fa-dollar-sign"></i> Variables
                    </button>
                    <button class="btn btn-secondary btn-block action-btn" data-action="pattern-library">
                        <i class="fas fa-book"></i> Patterns
                    </button>
                    <button class="btn btn-secondary btn-block action-btn" data-action="dependency-manager">
                        <i class="fas fa-sitemap"></i> Dependencies
                    </button>
                    <button class="btn btn-secondary btn-block action-btn" data-action="artifact-manager">
                        <i class="fas fa-archive"></i> Artifacts
                    </button>
                    <button class="btn btn-secondary btn-block action-btn" data-action="pipeline-preview">
                        <i class="fas fa-eye"></i> Preview
                    </button>
                    <button class="btn btn-secondary btn-block action-btn" data-action="sdk-tools">
                        <i class="fas fa-code"></i> SDK Tools
                    </button>
                </div>

                <!-- Templates -->
                <div class="sidebar-templates">
                    <h4><i class="fas fa-file-code"></i> Templates</h4>
                    <div class="template-list">
                        <div class="template-item" data-template="ci-cd">
                            <i class="fas fa-sync"></i> CI/CD Pipeline
                        </div>
                        <div class="template-item" data-template="docker">
                            <i class="fab fa-docker"></i> Docker Build
                        </div>
                        <div class="template-item" data-template="node">
                            <i class="fab fa-node-js"></i> Node.js App
                        </div>
                        <div class="template-item" data-template="python">
                            <i class="fab fa-python"></i> Python App
                        </div>
                        <div class="template-item" data-template="matrix">
                            <i class="fas fa-th"></i> Matrix Build
                        </div>
                    </div>
                </div>

                <!-- Plugin Quick Add -->
                <div class="sidebar-plugins">
                    <h4><i class="fas fa-puzzle-piece"></i> Popular Plugins</h4>
                    <div class="plugin-quick-list">
                        <button class="plugin-quick-add" data-plugin="docker-compose">
                            <i class="fab fa-docker"></i> Docker Compose
                        </button>
                        <button class="plugin-quick-add" data-plugin="artifacts">
                            <i class="fas fa-archive"></i> Artifacts
                        </button>
                        <button class="plugin-quick-add" data-plugin="test-collector">
                            <i class="fas fa-vial"></i> Test Collector
                        </button>
                    </div>
                </div>

                <!-- Help Section -->
                <div class="help-section">
                    <h4><i class="fas fa-question-circle"></i> Help</h4>
                    <p class="help-text">
                        Press <kbd>Ctrl</kbd>+<kbd>K</kbd> for command palette
                    </p>
                </div>
            </aside>

            <!-- Pipeline Builder - Center Column -->
            <section class="pipeline-builder pipeline-canvas canvas">
                <div class="pipeline-header canvas-header">
                    <h2><i class="fas fa-stream"></i> Pipeline Steps</h2>
                    <div class="pipeline-info canvas-controls">
                        <button id="toggle-yaml" class="btn btn-secondary btn-small">
                            <i class="fas fa-code"></i> Show YAML
                        </button>
                        <button id="validate-pipeline" class="btn btn-secondary btn-small">
                            <i class="fas fa-check-circle"></i> Validate
                        </button>
                        <button id="copy-yaml-inline" class="btn btn-secondary btn-small">
                            <i class="fas fa-copy"></i> Copy YAML
                        </button>
                        <span id="step-count" class="step-count">0 steps</span>
                    </div>
                </div>
                
                <!-- Pipeline Container -->
                <div class="pipeline-container">
                    <div id="pipeline-steps" class="pipeline-steps">
                        <div id="empty-state" class="empty-pipeline">
                            <i class="fas fa-layer-group"></i>
                            <h3>Start Building Your Pipeline</h3>
                            <p>Drag steps here to build your pipeline</p>
                            <p class="hint">Start with a command step or load an example</p>
                            <div class="quick-start-buttons">
                                <button class="btn btn-primary" data-action="add-step" data-step-type="command">
                                    <i class="fas fa-plus"></i> Add Command Step
                                </button>
                                <button class="btn btn-secondary" data-action="load-template">
                                    <i class="fas fa-file-import"></i> Load Template
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- YAML Preview Section -->
                <div id="yaml-preview" class="yaml-output-section yaml-preview" style="display: none;">
                    <div class="yaml-header">
                        <h3><i class="fas fa-code"></i> Generated YAML</h3>
                        <div class="yaml-actions">
                            <button id="copy-yaml-preview" class="btn btn-secondary btn-small">
                                <i class="fas fa-copy"></i> Copy
                            </button>
                            <button id="validate-yaml-inline" class="btn btn-secondary btn-small">
                                <i class="fas fa-check"></i> Validate
                            </button>
                            <button id="download-yaml" class="btn btn-secondary btn-small">
                                <i class="fas fa-download"></i> Download
                            </button>
                        </div>
                    </div>
                    <pre class="yaml-output"><code id="yaml-output">steps: []</code></pre>
                    <div id="yaml-validation" class="yaml-validation hidden">
                        <div id="validation-content"></div>
                    </div>
                </div>
            </section>

            <!-- Properties Panel - Right Column -->
            <aside class="properties-panel" id="properties-panel">
                <div class="properties-header panel-header">
                    <h3><i class="fas fa-cog"></i> Step Properties</h3>
                </div>
                <div id="properties-content" class="properties-content panel-content">
                    <div class="no-selection">
                        <i class="fas fa-mouse-pointer"></i>
                        <p>Select a step to configure</p>
                    </div>
                </div>
            </aside>
        </main>
    </div>

    <!-- Command Palette -->
    <div id="command-palette" class="command-palette hidden">
        <div class="command-palette-content">
            <input type="text" id="command-search" class="command-search" placeholder="Type a command...">
            <div id="command-results" class="command-list command-results">
                <div class="command-item" data-action="add-command-step">
                    <i class="fas fa-terminal"></i>
                    <span>Add Command Step</span>
                    <kbd>Ctrl+Shift+C</kbd>
                </div>
                <div class="command-item" data-action="add-wait-step">
                    <i class="fas fa-pause-circle"></i>
                    <span>Add Wait Step</span>
                </div>
                <div class="command-item" data-action="add-block-step">
                    <i class="fas fa-hand-paper"></i>
                    <span>Add Block Step</span>
                </div>
                <div class="command-item" data-action="add-input-step">
                    <i class="fas fa-keyboard"></i>
                    <span>Add Input Step</span>
                </div>
                <div class="command-item" data-action="add-trigger-step">
                    <i class="fas fa-bolt"></i>
                    <span>Add Trigger Step</span>
                </div>
                <div class="command-item" data-action="add-group-step">
                    <i class="fas fa-object-group"></i>
                    <span>Add Group Step</span>
                </div>
                <div class="command-item" data-action="export-yaml">
                    <i class="fas fa-download"></i>
                    <span>Export YAML</span>
                    <kbd>Ctrl+E</kbd>
                </div>
                <div class="command-item" data-action="import-yaml">
                    <i class="fas fa-upload"></i>
                    <span>Import YAML</span>
                </div>
                <div class="command-item" data-action="clear-pipeline">
                    <i class="fas fa-trash"></i>
                    <span>Clear Pipeline</span>
                </div>
                <div class="command-item" data-action="load-example">
                    <i class="fas fa-file-import"></i>
                    <span>Load Example</span>
                    <kbd>Ctrl+O</kbd>
                </div>
                <div class="command-item" data-action="toggle-yaml">
                    <i class="fas fa-code"></i>
                    <span>Toggle YAML View</span>
                    <kbd>Ctrl+Y</kbd>
                </div>
                <div class="command-item" data-action="save-pipeline">
                    <i class="fas fa-save"></i>
                    <span>Save Pipeline</span>
                    <kbd>Ctrl+S</kbd>
                </div>
                <div class="command-item" data-action="plugin-catalog">
                    <i class="fas fa-plug"></i>
                    <span>Open Plugin Catalog</span>
                </div>
                <div class="command-item" data-action="matrix-builder">
                    <i class="fas fa-th"></i>
                    <span>Open Matrix Builder</span>
                </div>
                <div class="command-item" data-action="step-templates">
                    <i class="fas fa-file-code"></i>
                    <span>Browse Templates</span>
                </div>
                <div class="command-item" data-action="validate-pipeline">
                    <i class="fas fa-check-circle"></i>
                    <span>Validate Pipeline</span>
                </div>
                <div class="command-item" data-action="share-pipeline">
                    <i class="fas fa-share-alt"></i>
                    <span>Share Pipeline</span>
                </div>
                <div class="command-item" data-action="keyboard-shortcuts">
                    <i class="fas fa-keyboard"></i>
                    <span>Keyboard Shortcuts</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Modals -->
    <!-- YAML Output Modal -->
    <div id="yaml-output-modal" class="modal" style="display: none;">
        <div class="modal-content large">
            <div class="modal-header">
                <h2><i class="fas fa-code"></i> Pipeline YAML</h2>
                <button class="close-modal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="yaml-actions">
                    <button id="copy-yaml" class="btn btn-primary">
                        <i class="fas fa-copy"></i> Copy to Clipboard
                    </button>
                    <button id="download-yaml-modal" class="btn btn-secondary">
                        <i class="fas fa-download"></i> Download YAML
                    </button>
                    <button id="validate-yaml" class="btn btn-secondary">
                        <i class="fas fa-check"></i> Validate
                    </button>
                </div>
                <pre class="yaml-output"><code id="yaml-content"></code></pre>
                <div id="validation-result" class="validation-result"></div>
            </div>
        </div>
    </div>

    <!-- Step Templates Modal -->
    <div id="step-templates-modal" class="modal" style="display: none;">
        <div class="modal-content large">
            <div class="modal-header">
                <h2><i class="fas fa-clipboard-list"></i> Step Templates</h2>
                <button class="close-modal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="templates-info">
                    <p>Select a template to load a complete pipeline configuration</p>
                </div>
                <div class="template-categories">
                    <button class="template-cat active" data-category="all">All</button>
                    <button class="template-cat" data-category="testing">Testing</button>
                    <button class="template-cat" data-category="deployment">Deployment</button>
                    <button class="template-cat" data-category="docker">Docker</button>
                    <button class="template-cat" data-category="build">Build & Package</button>
                    <button class="template-cat" data-category="security">Security</button>
                    <button class="template-cat" data-category="notifications">Notifications</button>
                </div>
                
                <div id="template-list" class="template-list">
                    <!-- Testing Templates -->
                    <div class="template-category" data-category="testing">
                        <h4><i class="fas fa-vial"></i> Testing</h4>
                        <div class="template-grid">
                            <div class="template-item" data-template="unit-tests">
                                <i class="fas fa-flask"></i>
                                <h5>Unit Tests</h5>
                                <p>Run unit tests with coverage reporting</p>
                                <div class="template-tags">
                                    <span class="tag">Jest</span>
                                    <span class="tag">Coverage</span>
                                </div>
                            </div>
                            <div class="template-item" data-template="integration-tests">
                                <i class="fas fa-network-wired"></i>
                                <h5>Integration Tests</h5>
                                <p>End-to-end integration testing</p>
                                <div class="template-tags">
                                    <span class="tag">Cypress</span>
                                    <span class="tag">E2E</span>
                                </div>
                            </div>
                            <div class="template-item" data-template="parallel-tests">
                                <i class="fas fa-tasks"></i>
                                <h5>Parallel Tests</h5>
                                <p>Split tests across multiple agents</p>
                                <div class="template-tags">
                                    <span class="tag">Parallel</span>
                                    <span class="tag">Performance</span>
                                </div>
                            </div>
                            <div class="template-item" data-template="security-scan">
                                <i class="fas fa-shield-alt"></i>
                                <h5>Security Scan</h5>
                                <p>Code security vulnerability scanning</p>
                                <div class="template-tags">
                                    <span class="tag">Security</span>
                                    <span class="tag">SAST</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Build & Package Templates -->
                    <div class="template-category" data-category="build">
                        <h4><i class="fas fa-tools"></i> Build & Package</h4>
                        <div class="template-grid">
                            <div class="template-item" data-template="node-build">
                                <i class="fab fa-node-js"></i>
                                <h5>Node.js Build</h5>
                                <p>Build Node.js applications</p>
                                <div class="template-tags">
                                    <span class="tag">Node</span>
                                    <span class="tag">NPM</span>
                                </div>
                            </div>
                            <div class="template-item" data-template="python-build">
                                <i class="fab fa-python"></i>
                                <h5>Python Build</h5>
                                <p>Build Python applications</p>
                                <div class="template-tags">
                                    <span class="tag">Python</span>
                                    <span class="tag">Pip</span>
                                </div>
                            </div>
                            <div class="template-item" data-template="go-build">
                                <i class="fas fa-cube"></i>
                                <h5>Go Build</h5>
                                <p>Build Go applications</p>
                                <div class="template-tags">
                                    <span class="tag">Go</span>
                                    <span class="tag">Binary</span>
                                </div>
                            </div>
                            <div class="template-item" data-template="multi-arch-build">
                                <i class="fas fa-microchip"></i>
                                <h5>Multi-Arch Build</h5>
                                <p>Build for multiple architectures</p>
                                <div class="template-tags">
                                    <span class="tag">ARM64</span>
                                    <span class="tag">AMD64</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Deployment Templates -->
                    <div class="template-category" data-category="deployment">
                        <h4><i class="fas fa-rocket"></i> Deployment</h4>
                        <div class="template-grid">
                            <div class="template-item" data-template="k8s-deploy">
                                <i class="fas fa-dharmachakra"></i>
                                <h5>Kubernetes Deploy</h5>
                                <p>Deploy to Kubernetes cluster</p>
                                <div class="template-tags">
                                    <span class="tag">K8s</span>
                                    <span class="tag">Helm</span>
                                </div>
                            </div>
                            <div class="template-item" data-template="aws-deploy">
                                <i class="fab fa-aws"></i>
                                <h5>AWS Deploy</h5>
                                <p>Deploy to AWS services</p>
                                <div class="template-tags">
                                    <span class="tag">ECS</span>
                                    <span class="tag">Lambda</span>
                                </div>
                            </div>
                            <div class="template-item" data-template="gcp-deploy">
                                <i class="fab fa-google"></i>
                                <h5>GCP Deploy</h5>
                                <p>Deploy to Google Cloud</p>
                                <div class="template-tags">
                                    <span class="tag">GKE</span>
                                    <span class="tag">Cloud Run</span>
                                </div>
                            </div>
                            <div class="template-item" data-template="static-deploy">
                                <i class="fas fa-globe"></i>
                                <h5>Static Site Deploy</h5>
                                <p>Deploy static websites</p>
                                <div class="template-tags">
                                    <span class="tag">CDN</span>
                                    <span class="tag">S3</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Docker Templates -->
                    <div class="template-category" data-category="docker">
                        <h4><i class="fab fa-docker"></i> Docker</h4>
                        <div class="template-grid">
                            <div class="template-item" data-template="docker-build">
                                <i class="fas fa-box"></i>
                                <h5>Docker Build</h5>
                                <p>Build Docker images</p>
                                <div class="template-tags">
                                    <span class="tag">Docker</span>
                                    <span class="tag">Build</span>
                                </div>
                            </div>
                            <div class="template-item" data-template="docker-compose">
                                <i class="fas fa-layer-group"></i>
                                <h5>Docker Compose</h5>
                                <p>Run with docker-compose</p>
                                <div class="template-tags">
                                    <span class="tag">Compose</span>
                                    <span class="tag">Multi-Container</span>
                                </div>
                            </div>
                            <div class="template-item" data-template="docker-push">
                                <i class="fas fa-cloud-upload-alt"></i>
                                <h5>Docker Push</h5>
                                <p>Push images to registry</p>
                                <div class="template-tags">
                                    <span class="tag">Registry</span>
                                    <span class="tag">ECR</span>
                                </div>
                            </div>
                            <div class="template-item" data-template="docker-scan">
                                <i class="fas fa-search-plus"></i>
                                <h5>Docker Scan</h5>
                                <p>Scan images for vulnerabilities</p>
                                <div class="template-tags">
                                    <span class="tag">Security</span>
                                    <span class="tag">Trivy</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Plugin Catalog Modal -->
    <div id="plugin-catalog-modal" class="modal" style="display: none;">
        <div class="modal-content large">
            <div class="modal-header">
                <h2><i class="fas fa-store"></i> Plugin Catalog</h2>
                <button class="close-modal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="plugin-search">
                    <input type="text" id="plugin-search" placeholder="Search plugins...">
                    <div class="plugin-filters">
                        <button class="filter-btn active" data-filter="all">All</button>
                        <button class="filter-btn" data-filter="testing">Testing</button>
                        <button class="filter-btn" data-filter="deployment">Deployment</button>
                        <button class="filter-btn" data-filter="docker">Docker</button>
                        <button class="filter-btn" data-filter="notifications">Notifications</button>
                        <button class="filter-btn" data-filter="security">Security</button>
                    </div>
                </div>
                <div id="plugin-list" class="plugin-list"></div>
            </div>
        </div>
    </div>

    <!-- Matrix Builder Modal -->
    <div id="matrix-builder-modal" class="modal" style="display: none;">
        <div class="modal-content large">
            <div class="modal-header">
                <h2><i class="fas fa-th"></i> Matrix Build Configuration</h2>
                <button class="close-modal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="matrix-builder">
                    <div class="matrix-info">
                        <p>Configure build matrices to run the same step with different parameter combinations.</p>
                    </div>
                    
                    <div class="matrix-dimensions">
                        <h3>Matrix Dimensions</h3>
                        <div id="matrix-dimensions-list"></div>
                        <button id="add-matrix-dimension" class="btn btn-secondary">
                            <i class="fas fa-plus"></i> Add Dimension
                        </button>
                    </div>
                    
                    <div class="matrix-preview">
                        <h3>Preview</h3>
                        <div id="matrix-preview-content">
                            <p class="empty-state">Add dimensions to see matrix preview</p>
                        </div>
                    </div>
                    
                    <div class="matrix-options">
                        <h4>Options</h4>
                        <div class="property-group">
                            <label for="matrix-max-parallel">Max Parallel Jobs</label>
                            <input type="number" id="matrix-max-parallel" value="10" min="1" max="50" placeholder="Default: no limit">
                            <small>Maximum number of jobs to run in parallel</small>
                        </div>
                    </div>
                    
                    <div class="matrix-actions">
                        <button class="btn btn-secondary close-modal">Cancel</button>
                        <button id="apply-matrix" class="btn btn-primary">
                            <i class="fas fa-check"></i> Apply to Step
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Conditional Logic Builder Modal -->
    <div id="conditional-logic-modal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h2><i class="fas fa-code-branch"></i> Conditional Logic Builder</h2>
                <button class="close-modal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="condition-builder">
                    <div class="condition-type">
                        <label>Condition Type:</label>
                        <select id="condition-type">
                            <option value="if">If (condition)</option>
                            <option value="unless">Unless (negative condition)</option>
                        </select>
                    </div>
                    <div class="condition-presets">
                        <h4>Common Conditions</h4>
                        <button class="condition-preset" data-condition="build.branch == 'main'">Main Branch Only</button>
                        <button class="condition-preset" data-condition="build.pull_request.id != null">Pull Requests Only</button>
                        <button class="condition-preset" data-condition="build.tag != null">Tagged Builds</button>
                        <button class="condition-preset" data-condition="build.source == 'schedule'">Scheduled Builds</button>
                    </div>
                    <div class="condition-builder-visual">
                        <h4>Build Custom Condition</h4>
                        <div id="condition-builder-content"></div>
                        <button id="add-condition-group" class="btn btn-secondary">
                            <i class="fas fa-plus"></i> Add Condition
                        </button>
                    </div>
                    <div class="condition-editor">
                        <label>Custom Condition Expression</label>
                        <textarea id="condition-expression" rows="3" placeholder="e.g., build.branch == 'main' && build.pull_request.id == null"></textarea>
                        <small>Use Buildkite environment variables and logical operators</small>
                    </div>
                    <div class="condition-preview">
                        <h4>Generated Condition</h4>
                        <code id="condition-preview-text"></code>
                    </div>
                    <div class="condition-actions">
                        <button id="apply-condition" class="btn btn-primary">Apply Condition</button>
                        <button class="btn btn-secondary close-modal">Cancel</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Variable Manager Modal -->
    <div id="variable-manager-modal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h2><i class="fas fa-dollar-sign"></i> Environment Variables</h2>
                <button class="close-modal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="variable-manager">
                    <div class="variable-section">
                        <h3>Pipeline Variables</h3>
                        <div id="pipeline-variables" class="variable-list">
                            <div class="empty-state">
                                <p>No environment variables defined</p>
                            </div>
                        </div>
                        <button id="add-pipeline-variable" class="btn btn-secondary">
                            <i class="fas fa-plus"></i> Add Variable
                        </button>
                    </div>
                    
                    <div class="variable-section">
                        <h4>Build Options</h4>
                        <div id="build-options" class="build-options-form">
                            <div class="property-group">
                                <label for="build-branch">Default Branch</label>
                                <input type="text" id="build-branch" placeholder="main">
                            </div>
                            <div class="property-group">
                                <label for="build-timeout">Global Timeout (minutes)</label>
                                <input type="number" id="build-timeout" placeholder="60" min="1">
                            </div>
                            <div class="property-checkbox">
                                <input type="checkbox" id="skip-queued">
                                <label for="skip-queued">Skip intermediate builds</label>
                            </div>
                            <div class="property-checkbox">
                                <input type="checkbox" id="cancel-running">
                                <label for="cancel-running">Cancel running builds on new commit</label>
                            </div>
                        </div>
                    </div>
                    
                    <div class="variable-info">
                        <h4>Available Buildkite Variables</h4>
                        <ul>
                            <li><code>BUILDKITE_BRANCH</code> - Git branch</li>
                            <li><code>BUILDKITE_COMMIT</code> - Git commit</li>
                            <li><code>BUILDKITE_BUILD_NUMBER</code> - Build number</li>
                            <li><code>BUILDKITE_TAG</code> - Git tag (if present)</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Pattern Library Modal -->
    <div id="pattern-library-modal" class="modal" style="display: none;">
        <div class="modal-content large">
            <div class="modal-header">
                <h2><i class="fas fa-book"></i> Pipeline Pattern Library</h2>
                <button class="close-modal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="pattern-categories">
                    <button class="pattern-cat active" data-category="all">All Patterns</button>
                    <button class="pattern-cat" data-category="monorepo">Monorepo</button>
                    <button class="pattern-cat" data-category="microservices">Microservices</button>
                    <button class="pattern-cat" data-category="mobile">Mobile Apps</button>
                    <button class="pattern-cat" data-category="ml">Machine Learning</button>
                </div>
                
                <div id="pattern-list" class="pattern-list">
                    <!-- Microservices Patterns -->
                    <div class="pattern-section" data-category="microservices">
                        <h4>Microservices Patterns</h4>
                        <div class="pattern-grid">
                            <div class="pattern-card" data-pattern="microservice-cicd">
                                <h5><i class="fas fa-cubes"></i> Microservice CI/CD</h5>
                                <p>Complete microservice pipeline with testing, building, and deployment</p>
                                <div class="pattern-preview">
                                    <code>
steps:
  - label: ":test_tube: Test"
    command: "make test"
    
  - wait
  
  - label: ":docker: Build & Push"
    plugins:
      - docker#v3.8.0:
          image: "myapp"
          
  - wait
  
  - label: ":kubernetes: Deploy"
    command: "kubectl apply -f k8s/"
                                    </code>
                                </div>
                                <button class="btn btn-primary btn-small use-pattern">Use This Pattern</button>
                            </div>
                            
                            <div class="pattern-card" data-pattern="service-mesh">
                                <h5><i class="fas fa-project-diagram"></i> Service Mesh Deploy</h5>
                                <p>Deploy microservices with Istio/Linkerd integration</p>
                                <div class="pattern-preview">
                                    <code>
steps:
  - label: ":istio: Service Mesh Config"
    command: |
      istioctl analyze
      kubectl apply -f istio/
                                    </code>
                                </div>
                                <button class="btn btn-primary btn-small use-pattern">Use This Pattern</button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Monorepo Patterns -->
                    <div class="pattern-section" data-category="monorepo">
                        <h4>Monorepo Patterns</h4>
                        <div class="pattern-grid">
                            <div class="pattern-card" data-pattern="monorepo-pipeline">
                                <h5><i class="fas fa-code-branch"></i> Monorepo Pipeline</h5>
                                <p>Handle multiple projects in a monorepo with path-based triggers</p>
                                <div class="pattern-preview">
                                    <code>
steps:
  - label: ":mag: Detect Changes"
    command: |
      ./scripts/detect-changes.sh
      
  - wait
  
  - label: ":package: Build Changed"
    command: |
      ./scripts/build-changed.sh
                                    </code>
                                </div>
                                <button class="btn btn-primary btn-small use-pattern">Use This Pattern</button>
                            </div>
                            
                            <div class="pattern-card" data-pattern="selective-builds">
                                <h5><i class="fas fa-filter"></i> Selective Builds</h5>
                                <p>Build only changed packages using Git diff</p>
                                <div class="pattern-preview">
                                    <code>
steps:
  - label: ":git: Check Changes"
    plugins:
      - monorepo-diff#v1.0.0:
          diff: "git diff --name-only HEAD~1"
          watch:
            - path: "services/api"
              command: "make test-api"
                                    </code>
                                </div>
                                <button class="btn btn-primary btn-small use-pattern">Use This Pattern</button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Mobile Patterns -->
                    <div class="pattern-section" data-category="mobile">
                        <h4>Mobile App Patterns</h4>
                        <div class="pattern-grid">
                            <div class="pattern-card" data-pattern="ios-pipeline">
                                <h5><i class="fab fa-apple"></i> iOS App Pipeline</h5>
                                <p>Build, test, and deploy iOS applications</p>
                                <div class="pattern-preview">
                                    <code>
steps:
  - label: ":ios: Build iOS"
    command: |
      fastlane ios build
    agents:
      queue: "mac-os"
                                    </code>
                                </div>
                                <button class="btn btn-primary btn-small use-pattern">Use This Pattern</button>
                            </div>
                            
                            <div class="pattern-card" data-pattern="android-pipeline">
                                <h5><i class="fab fa-android"></i> Android App Pipeline</h5>
                                <p>Build, test, and deploy Android applications</p>
                                <div class="pattern-preview">
                                    <code>
steps:
  - label: ":android: Build APK"
    command: |
      ./gradlew assembleRelease
                                    </code>
                                </div>
                                <button class="btn btn-primary btn-small use-pattern">Use This Pattern</button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- ML Patterns -->
                    <div class="pattern-section" data-category="ml">
                        <h4>Machine Learning Patterns</h4>
                        <div class="pattern-grid">
                            <div class="pattern-card" data-pattern="ml-training">
                                <h5><i class="fas fa-brain"></i> ML Model Training</h5>
                                <p>Train and validate machine learning models</p>
                                <div class="pattern-preview">
                                    <code>
steps:
  - label: ":brain: Train Model"
    command: |
      python train.py
    agents:
      gpu: "true"
                                    </code>
                                </div>
                                <button class="btn btn-primary btn-small use-pattern">Use This Pattern</button>
                            </div>
                            
                            <div class="pattern-card" data-pattern="ml-deployment">
                                <h5><i class="fas fa-rocket"></i> ML Model Deployment</h5>
                                <p>Deploy ML models to production</p>
                                <div class="pattern-preview">
                                    <code>
steps:
  - label: ":package: Package Model"
    command: |
      python package_model.py
      
  - label: ":rocket: Deploy"
    command: |
      kubectl apply -f ml-serving/
                                    </code>
                                </div>
                                <button class="btn btn-primary btn-small use-pattern">Use This Pattern</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- YAML Export Modal - REMOVED: Using yaml-output-modal instead -->

    <!-- Pipeline Sharing Modal -->
    <div id="share-pipeline-modal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h2><i class="fas fa-share-alt"></i> Share Pipeline</h2>
                <button class="close-modal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="share-options">
                    <div class="share-link-section">
                        <h3>Share Link</h3>
                        <p>Anyone with this link can view and import your pipeline</p>
                        <div class="share-link-input">
                            <input type="text" id="share-link" readonly>
                            <button id="copy-share-link" class="btn btn-secondary">
                                <i class="fas fa-copy"></i> Copy
                            </button>
                        </div>
                    </div>
                    <div class="share-export-section">
                        <h3>Export Options</h3>
                        <button id="export-json" class="btn btn-secondary">
                            <i class="fas fa-file-export"></i> Export as JSON
                        </button>
                        <button id="export-yaml-share" class="btn btn-secondary">
                            <i class="fas fa-file-code"></i> Export as YAML
                        </button>
                    </div>
                    <div class="share-qr-section">
                        <h3>QR Code</h3>
                        <div id="share-qr-code"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Dependency Manager Modal -->
    <div id="dependency-manager-modal" class="modal" style="display: none;">
        <div class="modal-content large">
            <div class="modal-header">
                <h3><i class="fas fa-sitemap"></i> Dependency Manager</h3>
                <button class="close-modal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="dependency-manager">
                    <div class="dependency-visualization">
                        <h4>Dependency Graph</h4>
                        <div id="dependency-graph" class="dependency-graph">
                            <canvas id="dependency-canvas"></canvas>
                        </div>
                    </div>
                    
                    <div class="dependency-configuration">
                        <h4>Configure Dependencies</h4>
                        <div class="dependency-list" id="dependency-list">
                            <!-- Dynamic dependency configuration -->
                        </div>
                        
                        <div class="dependency-options">
                            <h5>Dependency Options</h5>
                            <div class="property-checkbox">
                                <input type="checkbox" id="allow-failure">
                                <label for="allow-failure">Allow dependency failure</label>
                            </div>
                            <div class="property-checkbox">
                                <input type="checkbox" id="soft-fail">
                                <label for="soft-fail">Continue on soft fail</label>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Pipeline Validator Modal -->
    <div id="pipeline-validator-modal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-check-circle"></i> Pipeline Validator</h3>
                <button class="close-modal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="validator-content">
                    <div class="validation-status" id="validation-status">
                        <i class="fas fa-spinner fa-spin"></i>
                        <span>Validating pipeline...</span>
                    </div>
                    
                    <div class="validation-results" id="validation-results" style="display: none;">
                        <div class="validation-summary">
                            <h4>Validation Summary</h4>
                            <div class="summary-stats">
                                <div class="stat">
                                    <span class="stat-value" id="error-count">0</span>
                                    <span class="stat-label">Errors</span>
                                </div>
                                <div class="stat">
                                    <span class="stat-value" id="warning-count">0</span>
                                    <span class="stat-label">Warnings</span>
                                </div>
                                <div class="stat">
                                    <span class="stat-value" id="info-count">0</span>
                                    <span class="stat-label">Info</span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="validation-details" id="validation-details">
                            <!-- Dynamic validation results -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Pipeline Preview Modal -->
    <div id="pipeline-preview-modal" class="modal" style="display: none;">
        <div class="modal-content large">
            <div class="modal-header">
                <h3><i class="fas fa-eye"></i> Pipeline Preview</h3>
                <button class="close-modal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="preview-tabs">
                    <button class="tab-btn active" data-tab="visual">Visual</button>
                    <button class="tab-btn" data-tab="yaml">YAML</button>
                    <button class="tab-btn" data-tab="timeline">Timeline</button>
                </div>
                
                <div class="preview-content">
                    <div id="visual-preview" class="preview-tab active">
                        <div class="pipeline-visualization">
                            <!-- Dynamic visual representation -->
                        </div>
                    </div>
                    
                    <div id="yaml-preview-tab" class="preview-tab" style="display: none;">
                        <pre class="yaml-preview-code"><code id="preview-yaml-content"></code></pre>
                    </div>
                    
                    <div id="timeline-preview" class="preview-tab" style="display: none;">
                        <div class="timeline-visualization">
                            <!-- Timeline representation -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Validation Result Modal -->
    <div id="validation-modal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-check-circle"></i> Validation Results</h3>
                <button class="close-modal">&times;</button>
            </div>
            <div class="modal-body">
                <div id="validation-content"></div>
            </div>
        </div>
    </div>

    <!-- Environment Variables Manager Modal -->
    <div id="env-vars-modal" class="modal" style="display: none;">
        <div class="modal-content large">
            <div class="modal-header">
                <h2><i class="fas fa-key"></i> Environment Variables Manager</h2>
                <button class="close-modal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="env-vars-manager">
                    <div class="env-vars-info">
                        <p>Manage environment variables for your pipeline. Variables can be defined globally or per-step.</p>
                    </div>
                    
                    <div class="env-vars-tabs">
                        <button class="tab-btn active" data-tab="global">Global Variables</button>
                        <button class="tab-btn" data-tab="step">Step Variables</button>
                        <button class="tab-btn" data-tab="secrets">Secrets</button>
                    </div>
                    
                    <div class="env-vars-content">
                        <!-- Global Variables Tab -->
                        <div id="global-vars-tab" class="tab-content active">
                            <div class="env-vars-list" id="global-env-vars-list">
                                <!-- Variables will be rendered here -->
                            </div>
                            <button class="btn btn-secondary" id="add-global-env-var">
                                <i class="fas fa-plus"></i> Add Global Variable
                            </button>
                        </div>
                        
                        <!-- Step Variables Tab -->
                        <div id="step-vars-tab" class="tab-content" style="display: none;">
                            <div class="step-selector">
                                <label>Select Step:</label>
                                <select id="env-step-selector">
                                    <option value="">-- Select a step --</option>
                                </select>
                            </div>
                            <div class="env-vars-list" id="step-env-vars-list">
                                <!-- Step variables will be rendered here -->
                            </div>
                            <button class="btn btn-secondary" id="add-step-env-var" disabled>
                                <i class="fas fa-plus"></i> Add Step Variable
                            </button>
                        </div>
                        
                        <!-- Secrets Tab -->
                        <div id="secrets-tab" class="tab-content" style="display: none;">
                            <div class="secrets-info">
                                <i class="fas fa-info-circle"></i>
                                <p>Secrets are stored securely in Buildkite and not visible in logs. Reference them with: <code>$$SECRET_NAME</code></p>
                            </div>
                            <div class="env-vars-list" id="secrets-list">
                                <!-- Secrets will be rendered here -->
                            </div>
                            <button class="btn btn-secondary" id="add-secret">
                                <i class="fas fa-lock"></i> Add Secret
                            </button>
                        </div>
                    </div>
                    
                    <div class="env-vars-actions">
                        <button class="btn btn-primary" id="apply-env-vars">Apply Changes</button>
                        <button class="btn btn-secondary close-modal">Cancel</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Artifact Management Modal -->
    <div id="artifact-manager-modal" class="modal" style="display: none;">
        <div class="modal-content large">
            <div class="modal-header">
                <h2><i class="fas fa-archive"></i> Artifact Management</h2>
                <button class="close-modal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="artifact-manager">
                    <div class="artifact-info">
                        <p>Configure artifact paths and dependencies for your pipeline steps.</p>
                    </div>
                    
                    <div class="artifact-tabs">
                        <button class="tab-btn active" data-tab="paths">Artifact Paths</button>
                        <button class="tab-btn" data-tab="dependencies">Dependencies</button>
                        <button class="tab-btn" data-tab="retention">Retention Policy</button>
                    </div>
                    
                    <div class="artifact-content">
                        <!-- Artifact Paths Tab -->
                        <div id="paths-tab" class="tab-content active">
                            <div class="step-selector">
                                <label>Select Step:</label>
                                <select id="artifact-step-selector">
                                    <option value="">-- Select a step --</option>
                                </select>
                            </div>
                            
                            <div class="artifact-paths-section">
                                <h4>Upload Artifacts</h4>
                                <div class="artifact-paths-list" id="upload-paths-list">
                                    <!-- Upload paths will be rendered here -->
                                </div>
                                <button class="btn btn-secondary" id="add-upload-path">
                                    <i class="fas fa-upload"></i> Add Upload Path
                                </button>
                            </div>
                            
                            <div class="artifact-paths-section">
                                <h4>Download Artifacts</h4>
                                <div class="artifact-paths-list" id="download-paths-list">
                                    <!-- Download paths will be rendered here -->
                                </div>
                                <button class="btn btn-secondary" id="add-download-path">
                                    <i class="fas fa-download"></i> Add Download Path
                                </button>
                            </div>
                        </div>
                        
                        <!-- Dependencies Tab -->
                        <div id="dependencies-tab" class="tab-content" style="display: none;">
                            <div class="artifact-dependencies">
                                <h4>Artifact Dependencies</h4>
                                <p class="help-text">Configure which artifacts from previous steps this step requires.</p>
                                <div id="artifact-dependencies-list">
                                    <!-- Dependencies will be rendered here -->
                                </div>
                            </div>
                        </div>
                        
                        <!-- Retention Policy Tab -->
                        <div id="retention-tab" class="tab-content" style="display: none;">
                            <div class="retention-policy">
                                <h4>Retention Policy</h4>
                                <div class="form-group">
                                    <label>Default Retention Period:</label>
                                    <select id="retention-period">
                                        <option value="7">7 days</option>
                                        <option value="30" selected>30 days</option>
                                        <option value="90">90 days</option>
                                        <option value="365">1 year</option>
                                        <option value="0">Forever</option>
                                    </select>
                                </div>
                                
                                <div class="form-group">
                                    <label>
                                        <input type="checkbox" id="compress-artifacts">
                                        Compress artifacts before upload
                                    </label>
                                </div>
                                
                                <div class="form-group">
                                    <label>
                                        <input type="checkbox" id="encrypt-artifacts">
                                        Encrypt sensitive artifacts
                                    </label>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="artifact-actions">
                        <button class="btn btn-primary" id="apply-artifacts">Apply Changes</button>
                        <button class="btn btn-secondary close-modal">Cancel</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- API Configuration Modal -->
    <div id="api-config-modal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Buildkite API Configuration</h2>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <div class="api-config-form">
                    <div class="form-group">
                        <label for="api-token">API Token</label>
                        <input type="password" id="api-token" placeholder="Enter your Buildkite API token" class="form-control">
                        <small>Get your API token from <a href="https://buildkite.com/user/api-access-tokens" target="_blank">Buildkite Settings</a></small>
                    </div>
                    <div class="form-group">
                        <label for="api-organization">Organization Slug</label>
                        <input type="text" id="api-organization" placeholder="your-organization-slug" class="form-control">
                        <small>Your organization's URL slug (e.g., 'my-company' from buildkite.com/my-company)</small>
                    </div>
                    <div class="api-test-status" id="api-test-status"></div>
                    <div class="modal-actions">
                        <button id="clear-api-config" class="btn btn-danger" title="Remove saved configuration">
                            <i class="fas fa-trash"></i> Clear
                        </button>
                        <button id="test-api-connection" class="btn btn-secondary">
                            <i class="fas fa-plug"></i> Test Connection
                        </button>
                        <button id="save-api-config" class="btn btn-primary">
                            <i class="fas fa-save"></i> Save Configuration
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- SDK Tools Modal -->
    <div id="sdk-tools-modal" class="modal" style="display: none;">
        <div class="modal-content large">
            <div class="modal-header">
                <h3><i class="fas fa-code"></i> Buildkite SDK Tools</h3>
                <button class="close-modal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="sdk-tools-container">
                    <div class="sdk-section">
                        <h4><i class="fas fa-file-export"></i> Export to SDK Code</h4>
                        <p>Generate JavaScript or TypeScript code using the Buildkite SDK from your visual pipeline.</p>
                        <div class="sdk-options">
                            <label>
                                <input type="radio" name="sdk-language" value="javascript" checked>
                                JavaScript
                            </label>
                            <label>
                                <input type="radio" name="sdk-language" value="typescript">
                                TypeScript
                            </label>
                        </div>
                        <button id="export-sdk-code" class="btn btn-primary">
                            <i class="fas fa-download"></i> Generate SDK Code
                        </button>
                    </div>
                    
                    <div class="sdk-section">
                        <h4><i class="fas fa-file-import"></i> Import from SDK Code</h4>
                        <p>Convert SDK code back to visual pipeline (limited support).</p>
                        <textarea id="sdk-import-code" placeholder="Paste your SDK code here..." rows="10"></textarea>
                        <button id="import-sdk-code" class="btn btn-secondary">
                            <i class="fas fa-upload"></i> Import SDK Code
                        </button>
                    </div>
                    
                    <div class="sdk-section">
                        <h4><i class="fas fa-check-double"></i> SDK Validation</h4>
                        <p>Validate your pipeline using SDK-like rules and best practices.</p>
                        <button id="validate-sdk" class="btn btn-secondary">
                            <i class="fas fa-shield-alt"></i> Run SDK Validation
                        </button>
                        <div id="sdk-validation-results" class="validation-results" style="display: none;">
                            <!-- Validation results will appear here -->
                        </div>
                    </div>
                    
                    <div class="sdk-section">
                        <h4><i class="fas fa-terminal"></i> Generated Code</h4>
                        <div id="sdk-code-display" class="code-display" style="display: none;">
                            <div class="code-actions">
                                <button id="copy-sdk-code" class="btn btn-sm">
                                    <i class="fas fa-copy"></i> Copy
                                </button>
                                <button id="download-sdk-code" class="btn btn-sm">
                                    <i class="fas fa-download"></i> Download
                                </button>
                            </div>
                            <pre><code id="sdk-code-content"></code></pre>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Loading Overlay -->
    <div id="loading-overlay" class="loading-overlay" style="display: none;">
        <div class="spinner"></div>
        <p>Loading...</p>
    </div>

    <!-- Notification Container -->
    <div id="notification-container" class="notification-container"></div>

    <!-- Toast Container -->
    <div id="toast-container"></div>

    <!-- Hidden File Input for Import -->
    <input type="file" id="import-file" accept=".yml,.yaml" style="display: none;">

    <!-- Scripts - Load in correct order -->
    <!-- Performance Utilities -->
    <script src="js/performance-utils.js"></script>
    <script src="js/virtual-scroll.js"></script>
    
    <!-- Core Scripts First -->
    <script src="js/yaml-generator.js"></script>
    <script src="js/pipeline-builder.js"></script>
    
    <!-- UI Components -->
    <script src="js/properties-panel.js"></script>
    <script src="js/command-palette.js"></script>
    <script src="js/pipeline-templates.js"></script>
    
    <!-- Enhanced Features -->
    <script src="js/matrix-builder.js"></script>
    <script src="js/conditional-logic-builder.js"></script>
    <script src="js/pipeline-sharing.js"></script>
    <script src="js/env-var-manager.js"></script>
    <script src="js/pipeline-visualizer.js"></script>
    <script src="js/artifact-manager.js"></script>
    <script src="js/enhanced-pipeline-builder.js"></script>
    
    <!-- API Integration -->
    <script type="module" src="js/api-client.js"></script>
    
    <!-- SDK Integration -->
    <script src="js/buildkite-sdk-integration.js"></script>
    
    <!-- Main App Controller - Single point of initialization -->
    <script src="js/app.js"></script>
</body>
</html>