<!-- index.html -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Buildkite Pipeline Builder</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- Main Application -->
    <div id="app-container" class="app-container">
        <!-- Header -->
        <header class="header">
            <div class="header-content">
                <div class="header-brand">
                    <i class="fas fa-stream"></i>
                    <h1>Buildkite Pipeline Builder</h1>
                    <span class="version">Enhanced v2.0</span>
                </div>
                <div class="header-actions">
                    <button id="load-example" class="btn btn-secondary">
                        <i class="fas fa-file-import"></i>
                        Load Example
                    </button>
                    <button id="clear-pipeline" class="btn btn-secondary">
                        <i class="fas fa-trash"></i>
                        Clear All
                    </button>
                    <button id="export-yaml" class="btn btn-primary">
                        <i class="fas fa-download"></i>
                        Export YAML
                    </button>
                </div>
            </div>
        </header>

        <!-- Main Content - 3 Column Layout -->
        <main class="main-content">
            <!-- Enhanced Sidebar - Left Column -->
            <aside class="sidebar enhanced-sidebar">
                <div class="sidebar-header">
                    <h3><i class="fas fa-toolbox"></i> Step Types</h3>
                    <p>Drag steps to build your pipeline</p>
                </div>

                <!-- Core Steps -->
                <div class="step-category">
                    <h4><i class="fas fa-star"></i> Core Steps</h4>
                    <div class="step-palette">
                        <div class="step-type" draggable="true" data-step-type="command">
                            <i class="fas fa-terminal"></i>
                            <span>Command Step</span>
                            <small>Execute shell commands</small>
                        </div>
                        <div class="step-type" draggable="true" data-step-type="wait">
                            <i class="fas fa-hourglass-half"></i>
                            <span>Wait Step</span>
                            <small>Wait for previous steps</small>
                        </div>
                        <div class="step-type" draggable="true" data-step-type="block">
                            <i class="fas fa-hand-paper"></i>
                            <span>Block Step</span>
                            <small>Manual approval gate</small>
                        </div>
                        <div class="step-type" draggable="true" data-step-type="input">
                            <i class="fas fa-keyboard"></i>
                            <span>Input Step</span>
                            <small>Collect user input</small>
                        </div>
                        <div class="step-type" draggable="true" data-step-type="trigger">
                            <i class="fas fa-bolt"></i>
                            <span>Trigger Step</span>
                            <small>Trigger another pipeline</small>
                        </div>
                        <div class="step-type" draggable="true" data-step-type="group">
                            <i class="fas fa-layer-group"></i>
                            <span>Group Step</span>
                            <small>Group multiple steps</small>
                        </div>
                    </div>
                </div>

                <!-- Advanced Steps -->
                <div class="step-category">
                    <h4><i class="fas fa-tools"></i> Advanced</h4>
                    <div class="step-palette">
                        <div class="step-type advanced" draggable="true" data-step-type="pipeline-upload">
                            <i class="fas fa-cloud-upload-alt"></i>
                            <span>Pipeline Upload</span>
                            <small>Upload dynamic pipeline</small>
                        </div>
                        <div class="step-type advanced" draggable="true" data-step-type="annotation">
                            <i class="fas fa-comment-alt"></i>
                            <span>Annotation</span>
                            <small>Add build annotations</small>
                        </div>
                        <div class="step-type advanced" draggable="true" data-step-type="notify">
                            <i class="fas fa-bell"></i>
                            <span>Notify</span>
                            <small>Send notifications</small>
                        </div>
                        <div class="step-type advanced" draggable="true" data-step-type="plugin">
                            <i class="fas fa-puzzle-piece"></i>
                            <span>Plugin Step</span>
                            <small>Use Buildkite plugins</small>
                        </div>
                    </div>
                </div>

                <!-- Sidebar Actions -->
                <div class="sidebar-actions">
                    <!-- Quick Actions Grid -->
                    <div class="quick-actions">
                        <button class="action-btn" data-action="plugin-catalog">
                            <i class="fas fa-store"></i>
                            <span>Plugin Catalog</span>
                        </button>
                        <button class="action-btn" data-action="matrix-builder">
                            <i class="fas fa-th"></i>
                            <span>Matrix Builder</span>
                        </button>
                        <button class="action-btn" data-action="step-templates">
                            <i class="fas fa-file-alt"></i>
                            <span>Step Templates</span>
                        </button>
                        <button class="action-btn" data-action="variable-manager">
                            <i class="fas fa-cog"></i>
                            <span>Variables</span>
                        </button>
                    </div>
                    <!-- Pattern Library Link -->
                    <div class="pattern-library-link">
                        <button class="btn btn-outline btn-full" data-action="pattern-library">
                            <i class="fas fa-book"></i>
                            Pattern Library
                        </button>
                    </div>
                </div>
            </aside>

            <!-- Central Canvas -->
            <section class="canvas">
                <div class="canvas-header">
                    <h2>Pipeline Canvas</h2>
                    <div class="canvas-controls">
                        <span class="step-count">0 steps</span>
                        <button class="btn btn-secondary btn-small" id="toggle-yaml">
                            <i class="fas fa-code"></i>
                            Toggle YAML
                        </button>
                    </div>
                </div>

                <!-- Pipeline Container -->
                <div class="pipeline-container">
                    <div id="pipeline-steps" class="pipeline-steps">
                        <div id="empty-state" class="empty-pipeline">
                            <i class="fas fa-stream"></i>
                            <h3>Start Building Your Pipeline</h3>
                            <p>Drag step types from the sidebar to build your pipeline</p>
                        </div>
                    </div>
                </div>

                <!-- YAML Preview (Initially Hidden) -->
                <div id="yaml-preview" class="yaml-preview" style="display: none;">
                    <div class="yaml-header">
                        <h3>Pipeline YAML</h3>
                        <button class="btn btn-secondary btn-small" id="copy-yaml">
                            <i class="fas fa-copy"></i>
                            Copy
                        </button>
                    </div>
                    <pre><code id="yaml-output">steps: []</code></pre>
                </div>
            </section>

            <!-- Properties Panel - Right Column -->
            <aside class="properties-panel">
                <div class="properties-header">
                    <h3><i class="fas fa-sliders-h"></i> Step Properties</h3>
                </div>
                <div id="properties-content" class="properties-content">
                    <div class="no-selection">
                        <i class="fas fa-info-circle"></i>
                        <p>Select a step to view its properties</p>
                    </div>
                </div>
            </aside>
        </main>
    </div>

    <!-- Command Palette -->
    <div id="command-palette" class="command-palette" style="display: none;">
        <div class="command-palette-content">
            <input type="text" id="command-input" placeholder="Type a command or search...">
            <div id="command-results" class="command-results"></div>
        </div>
    </div>

    <!-- Plugin Catalog Modal -->
    <div id="plugin-catalog-modal" class="modal" style="display: none;">
        <div class="modal-content large">
            <div class="modal-header">
                <h3><i class="fas fa-store"></i> Plugin Catalog</h3>
                <button class="close-modal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="plugin-search">
                    <input type="text" id="plugin-search" placeholder="Search plugins...">
                    <div class="plugin-filters">
                        <button class="filter-btn active" data-filter="all">All</button>
                        <button class="filter-btn" data-filter="testing">Testing</button>
                        <button class="filter-btn" data-filter="deployment">Deployment</button>
                        <button class="filter-btn" data-filter="docker">Docker</button>
                        <button class="filter-btn" data-filter="notifications">Notifications</button>
                        <button class="filter-btn" data-filter="security">Security</button>
                    </div>
                </div>
                <div id="plugin-list" class="plugin-list">
                    <!-- Plugins will be dynamically populated -->
                </div>
            </div>
        </div>
    </div>

    <!-- Matrix Builder Modal -->
    <div id="matrix-builder-modal" class="modal" style="display: none;">
        <div class="modal-content large">
            <div class="modal-header">
                <h3><i class="fas fa-th"></i> Matrix Builder</h3>
                <button class="close-modal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="matrix-builder-content">
                    <div class="matrix-info">
                        <p>Configure build matrices to run the same step with different parameter combinations.</p>
                    </div>
                    
                    <div class="matrix-dimensions">
                        <h4>Matrix Dimensions</h4>
                        <div id="matrix-dimensions-list">
                            <!-- Dynamic matrix dimensions will be added here -->
                        </div>
                        <button class="btn btn-secondary" id="add-dimension">
                            <i class="fas fa-plus"></i> Add Dimension
                        </button>
                    </div>
                    
                    <div class="matrix-preview">
                        <h4>Preview</h4>
                        <div id="matrix-preview-content">
                            <p class="empty-state">Add dimensions to see matrix preview</p>
                        </div>
                    </div>
                    
                    <div class="matrix-options">
                        <h4>Options</h4>
                        <div class="property-group">
                            <label for="matrix-max-parallel">Max Parallel Jobs</label>
                            <input type="number" id="matrix-max-parallel" value="10" min="1" max="50">
                            <small>Maximum number of jobs to run in parallel</small>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary close-modal">Cancel</button>
                <button class="btn btn-primary" id="apply-matrix">Apply Matrix</button>
            </div>
        </div>
    </div>

    <!-- Step Templates Modal -->
    <div id="step-templates-modal" class="modal" style="display: none;">
        <div class="modal-content large">
            <div class="modal-header">
                <h3><i class="fas fa-file-alt"></i> Step Templates</h3>
                <button class="close-modal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="template-categories">
                    <button class="template-cat active" data-category="all">All</button>
                    <button class="template-cat" data-category="testing">Testing</button>
                    <button class="template-cat" data-category="deployment">Deployment</button>
                    <button class="template-cat" data-category="docker">Docker</button>
                    <button class="template-cat" data-category="security">Security</button>
                </div>
                
                <div id="template-list" class="template-list">
                    <!-- Testing Templates -->
                    <div class="template-category" data-category="testing">
                        <h4><i class="fas fa-vial"></i> Testing</h4>
                        <div class="template-grid">
                            <div class="template-item" data-template="unit-tests">
                                <i class="fas fa-flask"></i>
                                <h5>Unit Tests</h5>
                                <p>Run unit tests with coverage reporting</p>
                                <div class="template-tags">
                                    <span class="tag">Jest</span>
                                    <span class="tag">Coverage</span>
                                </div>
                            </div>
                            <div class="template-item" data-template="integration-tests">
                                <i class="fas fa-network-wired"></i>
                                <h5>Integration Tests</h5>
                                <p>End-to-end integration testing</p>
                                <div class="template-tags">
                                    <span class="tag">Cypress</span>
                                    <span class="tag">E2E</span>
                                </div>
                            </div>
                            <div class="template-item" data-template="parallel-tests">
                                <i class="fas fa-tasks"></i>
                                <h5>Parallel Tests</h5>
                                <p>Split tests across multiple agents</p>
                                <div class="template-tags">
                                    <span class="tag">Parallel</span>
                                    <span class="tag">Performance</span>
                                </div>
                            </div>
                            <div class="template-item" data-template="security-scan">
                                <i class="fas fa-shield-alt"></i>
                                <h5>Security Scan</h5>
                                <p>Code security vulnerability scanning</p>
                                <div class="template-tags">
                                    <span class="tag">Security</span>
                                    <span class="tag">SAST</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Build & Package Templates -->
                    <div class="template-category" data-category="build">
                        <h4><i class="fas fa-tools"></i> Build & Package</h4>
                        <div class="template-grid">
                            <div class="template-item" data-template="node-build">
                                <i class="fab fa-node-js"></i>
                                <h5>Node.js Build</h5>
                                <p>Build Node.js applications</p>
                                <div class="template-tags">
                                    <span class="tag">Node</span>
                                    <span class="tag">NPM</span>
                                </div>
                            </div>
                            <div class="template-item" data-template="python-build">
                                <i class="fab fa-python"></i>
                                <h5>Python Build</h5>
                                <p>Build Python applications</p>
                                <div class="template-tags">
                                    <span class="tag">Python</span>
                                    <span class="tag">Pip</span>
                                </div>
                            </div>
                            <div class="template-item" data-template="go-build">
                                <i class="fas fa-cube"></i>
                                <h5>Go Build</h5>
                                <p>Build Go applications</p>
                                <div class="template-tags">
                                    <span class="tag">Go</span>
                                    <span class="tag">Binary</span>
                                </div>
                            </div>
                            <div class="template-item" data-template="multi-arch-build">
                                <i class="fas fa-microchip"></i>
                                <h5>Multi-Arch Build</h5>
                                <p>Build for multiple architectures</p>
                                <div class="template-tags">
                                    <span class="tag">ARM64</span>
                                    <span class="tag">AMD64</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Deployment Templates -->
                    <div class="template-category" data-category="deployment">
                        <h4><i class="fas fa-rocket"></i> Deployment</h4>
                        <div class="template-grid">
                            <div class="template-item" data-template="k8s-deploy">
                                <i class="fas fa-dharmachakra"></i>
                                <h5>Kubernetes Deploy</h5>
                                <p>Deploy to Kubernetes cluster</p>
                                <div class="template-tags">
                                    <span class="tag">K8s</span>
                                    <span class="tag">Helm</span>
                                </div>
                            </div>
                            <div class="template-item" data-template="aws-deploy">
                                <i class="fab fa-aws"></i>
                                <h5>AWS Deploy</h5>
                                <p>Deploy to AWS services</p>
                                <div class="template-tags">
                                    <span class="tag">ECS</span>
                                    <span class="tag">Lambda</span>
                                </div>
                            </div>
                            <div class="template-item" data-template="gcp-deploy">
                                <i class="fab fa-google"></i>
                                <h5>GCP Deploy</h5>
                                <p>Deploy to Google Cloud</p>
                                <div class="template-tags">
                                    <span class="tag">GKE</span>
                                    <span class="tag">Cloud Run</span>
                                </div>
                            </div>
                            <div class="template-item" data-template="static-deploy">
                                <i class="fas fa-globe"></i>
                                <h5>Static Site Deploy</h5>
                                <p>Deploy static websites</p>
                                <div class="template-tags">
                                    <span class="tag">CDN</span>
                                    <span class="tag">S3</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Docker Templates -->
                    <div class="template-category" data-category="docker">
                        <h4><i class="fab fa-docker"></i> Docker</h4>
                        <div class="template-grid">
                            <div class="template-item" data-template="docker-build">
                                <i class="fas fa-box"></i>
                                <h5>Docker Build</h5>
                                <p>Build Docker images</p>
                                <div class="template-tags">
                                    <span class="tag">Docker</span>
                                    <span class="tag">Build</span>
                                </div>
                            </div>
                            <div class="template-item" data-template="docker-compose">
                                <i class="fas fa-layer-group"></i>
                                <h5>Docker Compose</h5>
                                <p>Run with docker-compose</p>
                                <div class="template-tags">
                                    <span class="tag">Compose</span>
                                    <span class="tag">Multi-Container</span>
                                </div>
                            </div>
                            <div class="template-item" data-template="docker-push">
                                <i class="fas fa-cloud-upload-alt"></i>
                                <h5>Docker Push</h5>
                                <p>Push images to registry</p>
                                <div class="template-tags">
                                    <span class="tag">Registry</span>
                                    <span class="tag">ECR</span>
                                </div>
                            </div>
                            <div class="template-item" data-template="docker-scan">
                                <i class="fas fa-search-plus"></i>
                                <h5>Docker Scan</h5>
                                <p>Scan images for vulnerabilities</p>
                                <div class="template-tags">
                                    <span class="tag">Security</span>
                                    <span class="tag">Trivy</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Variable Manager Modal -->
    <div id="variable-manager-modal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-cog"></i> Pipeline Variables</h3>
                <button class="close-modal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="variable-manager">
                    <div class="variable-section">
                        <h4>Environment Variables</h4>
                        <div id="env-variables" class="variable-list">
                            <div class="empty-state">
                                <p>No environment variables defined</p>
                            </div>
                        </div>
                        <button class="btn btn-secondary" id="add-env-var">
                            <i class="fas fa-plus"></i> Add Variable
                        </button>
                    </div>
                    
                    <div class="variable-section">
                        <h4>Build Options</h4>
                        <div id="build-options" class="build-options-form">
                            <div class="property-group">
                                <label for="build-branch">Default Branch</label>
                                <input type="text" id="build-branch" placeholder="main">
                            </div>
                            <div class="property-group">
                                <label for="build-timeout">Global Timeout (minutes)</label>
                                <input type="number" id="build-timeout" placeholder="60" min="1">
                            </div>
                            <div class="property-checkbox">
                                <input type="checkbox" id="skip-queued">
                                <label for="skip-queued">Skip intermediate builds</label>
                            </div>
                            <div class="property-checkbox">
                                <input type="checkbox" id="cancel-running">
                                <label for="cancel-running">Cancel running builds on new commit</label>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Pattern Library Modal -->
    <div id="pattern-library-modal" class="modal" style="display: none;">
        <div class="modal-content large">
            <div class="modal-header">
                <h3><i class="fas fa-book"></i> Pipeline Pattern Library</h3>
                <button class="close-modal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="pattern-categories">
                    <button class="pattern-cat active" data-category="all">All Patterns</button>
                    <button class="pattern-cat" data-category="microservices">Microservices</button>
                    <button class="pattern-cat" data-category="monorepo">Monorepo</button>
                    <button class="pattern-cat" data-category="mobile">Mobile Apps</button>
                    <button class="pattern-cat" data-category="ml">Machine Learning</button>
                </div>
                
                <div id="pattern-list" class="pattern-list">
                    <!-- Microservices Patterns -->
                    <div class="pattern-section" data-category="microservices">
                        <h4>Microservices Patterns</h4>
                        <div class="pattern-grid">
                            <div class="pattern-card" data-pattern="microservice-cicd">
                                <h5><i class="fas fa-cubes"></i> Microservice CI/CD</h5>
                                <p>Complete microservice pipeline with testing, building, and deployment</p>
                                <div class="pattern-preview">
                                    <code>
steps:
  - label: ":test_tube: Test"
    command: "make test"
    
  - wait
  
  - label: ":docker: Build & Push"
    plugins:
      - docker#v3.8.0:
          image: "myapp"
          
  - wait
  
  - label: ":kubernetes: Deploy"
    command: "kubectl apply -f k8s/"
                                    </code>
                                </div>
                                <button class="btn btn-primary btn-small use-pattern">Use This Pattern</button>
                            </div>
                            
                            <div class="pattern-card" data-pattern="service-mesh">
                                <h5><i class="fas fa-project-diagram"></i> Service Mesh Deploy</h5>
                                <p>Deploy microservices with Istio/Linkerd integration</p>
                                <div class="pattern-preview">
                                    <code>
steps:
  - label: ":istio: Service Mesh Config"
    command: |
      istioctl analyze
      kubectl apply -f istio/
                                    </code>
                                </div>
                                <button class="btn btn-primary btn-small use-pattern">Use This Pattern</button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Monorepo Patterns -->
                    <div class="pattern-section" data-category="monorepo">
                        <h4>Monorepo Patterns</h4>
                        <div class="pattern-grid">
                            <div class="pattern-card" data-pattern="monorepo-pipeline">
                                <h5><i class="fas fa-code-branch"></i> Monorepo Pipeline</h5>
                                <p>Handle multiple projects in a monorepo with path-based triggers</p>
                                <div class="pattern-preview">
                                    <code>
steps:
  - label: ":mag: Detect Changes"
    command: |
      ./scripts/detect-changes.sh
      
  - wait
  
  - label: ":package: Build Changed"
    command: |
      ./scripts/build-changed.sh
                                    </code>
                                </div>
                                <button class="btn btn-primary btn-small use-pattern">Use This Pattern</button>
                            </div>
                            
                            <div class="pattern-card" data-pattern="selective-builds">
                                <h5><i class="fas fa-filter"></i> Selective Builds</h5>
                                <p>Build only changed packages using Git diff</p>
                                <div class="pattern-preview">
                                    <code>
steps:
  - label: ":git: Check Changes"
    plugins:
      - monorepo-diff#v1.0.0:
          diff: "git diff --name-only HEAD~1"
          watch:
            - path: "services/api"
              command: "make test-api"
                                    </code>
                                </div>
                                <button class="btn btn-primary btn-small use-pattern">Use This Pattern</button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Mobile Patterns -->
                    <div class="pattern-section" data-category="mobile">
                        <h4>Mobile App Patterns</h4>
                        <div class="pattern-grid">
                            <div class="pattern-card" data-pattern="ios-pipeline">
                                <h5><i class="fab fa-apple"></i> iOS App Pipeline</h5>
                                <p>Build, test, and deploy iOS applications</p>
                                <div class="pattern-preview">
                                    <code>
steps:
  - label: ":ios: Build iOS"
    command: |
      fastlane ios build
    agents:
      queue: "mac-os"
                                    </code>
                                </div>
                                <button class="btn btn-primary btn-small use-pattern">Use This Pattern</button>
                            </div>
                            
                            <div class="pattern-card" data-pattern="android-pipeline">
                                <h5><i class="fab fa-android"></i> Android App Pipeline</h5>
                                <p>Build, test, and deploy Android applications</p>
                                <div class="pattern-preview">
                                    <code>
steps:
  - label: ":android: Build APK"
    command: |
      ./gradlew assembleRelease
                                    </code>
                                </div>
                                <button class="btn btn-primary btn-small use-pattern">Use This Pattern</button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- ML Patterns -->
                    <div class="pattern-section" data-category="ml">
                        <h4>Machine Learning Patterns</h4>
                        <div class="pattern-grid">
                            <div class="pattern-card" data-pattern="ml-training">
                                <h5><i class="fas fa-brain"></i> ML Model Training</h5>
                                <p>Train and validate machine learning models</p>
                                <div class="pattern-preview">
                                    <code>
steps:
  - label: ":brain: Train Model"
    command: |
      python train.py
    agents:
      gpu: "true"
                                    </code>
                                </div>
                                <button class="btn btn-primary btn-small use-pattern">Use This Pattern</button>
                            </div>
                            
                            <div class="pattern-card" data-pattern="ml-deployment">
                                <h5><i class="fas fa-rocket"></i> ML Model Deployment</h5>
                                <p>Deploy ML models to production</p>
                                <div class="pattern-preview">
                                    <code>
steps:
  - label: ":package: Package Model"
    command: |
      python package_model.py
      
  - label: ":rocket: Deploy"
    command: |
      kubectl apply -f ml-serving/
                                    </code>
                                </div>
                                <button class="btn btn-primary btn-small use-pattern">Use This Pattern</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Dependency Manager Modal -->
    <div id="dependency-manager-modal" class="modal" style="display: none;">
        <div class="modal-content large">
            <div class="modal-header">
                <h3><i class="fas fa-sitemap"></i> Dependency Manager</h3>
                <button class="close-modal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="dependency-manager">
                    <div class="dependency-visualization">
                        <h4>Dependency Graph</h4>
                        <div id="dependency-graph" class="dependency-graph">
                            <canvas id="dependency-canvas"></canvas>
                        </div>
                    </div>
                    
                    <div class="dependency-configuration">
                        <h4>Configure Dependencies</h4>
                        <div class="dependency-list" id="dependency-list">
                            <!-- Dynamic dependency configuration -->
                        </div>
                        
                        <div class="dependency-options">
                            <h5>Dependency Options</h5>
                            <div class="property-checkbox">
                                <input type="checkbox" id="allow-failure">
                                <label for="allow-failure">Allow dependency failure</label>
                            </div>
                            <div class="property-checkbox">
                                <input type="checkbox" id="soft-fail">
                                <label for="soft-fail">Continue on soft fail</label>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Conditional Builder Modal -->
    <div id="conditional-builder-modal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-code-branch"></i> Conditional Builder</h3>
                <button class="close-modal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="conditional-builder">
                    <div class="condition-type">
                        <label>Condition Type</label>
                        <select id="condition-type">
                            <option value="if">If (run when true)</option>
                            <option value="unless">Unless (skip when true)</option>
                        </select>
                    </div>
                    
                    <div class="condition-presets">
                        <h4>Common Conditions</h4>
                        <div class="preset-grid">
                            <button class="preset-btn" data-condition="build.branch == 'main'">
                                Main Branch Only
                            </button>
                            <button class="preset-btn" data-condition="build.pull_request.id == null">
                                Not a Pull Request
                            </button>
                            <button class="preset-btn" data-condition="build.tag != null">
                                Tagged Builds Only
                            </button>
                            <button class="preset-btn" data-condition="build.source == 'schedule'">
                                Scheduled Builds
                            </button>
                        </div>
                    </div>
                    
                    <div class="condition-editor">
                        <label>Custom Condition</label>
                        <textarea id="condition-expression" rows="3" placeholder="e.g., build.branch == 'main' && build.pull_request.id == null"></textarea>
                        <small>Use Buildkite environment variables and logical operators</small>
                    </div>
                    
                    <div class="condition-preview">
                        <h4>Preview</h4>
                        <code id="condition-preview-text">No condition set</code>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary close-modal">Cancel</button>
                <button class="btn btn-primary" id="apply-condition">Apply Condition</button>
            </div>
        </div>
    </div>

    <!-- Pipeline Validator Modal -->
    <div id="pipeline-validator-modal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-check-circle"></i> Pipeline Validator</h3>
                <button class="close-modal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="validator-content">
                    <div class="validation-status" id="validation-status">
                        <i class="fas fa-spinner fa-spin"></i>
                        <span>Validating pipeline...</span>
                    </div>
                    
                    <div class="validation-results" id="validation-results" style="display: none;">
                        <div class="validation-summary">
                            <h4>Validation Summary</h4>
                            <div class="summary-stats">
                                <div class="stat">
                                    <span class="stat-value" id="error-count">0</span>
                                    <span class="stat-label">Errors</span>
                                </div>
                                <div class="stat">
                                    <span class="stat-value" id="warning-count">0</span>
                                    <span class="stat-label">Warnings</span>
                                </div>
                                <div class="stat">
                                    <span class="stat-value" id="info-count">0</span>
                                    <span class="stat-label">Info</span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="validation-details" id="validation-details">
                            <!-- Dynamic validation results -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Pipeline Preview Modal -->
    <div id="pipeline-preview-modal" class="modal" style="display: none;">
        <div class="modal-content large">
            <div class="modal-header">
                <h3><i class="fas fa-eye"></i> Pipeline Preview</h3>
                <button class="close-modal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="preview-tabs">
                    <button class="tab-btn active" data-tab="visual">Visual</button>
                    <button class="tab-btn" data-tab="yaml">YAML</button>
                    <button class="tab-btn" data-tab="timeline">Timeline</button>
                </div>
                
                <div class="preview-content">
                    <div id="visual-preview" class="preview-tab active">
                        <div class="pipeline-visualization">
                            <!-- Dynamic visual representation -->
                        </div>
                    </div>
                    
                    <div id="yaml-preview-tab" class="preview-tab" style="display: none;">
                        <pre class="yaml-preview-code"><code id="preview-yaml-content"></code></pre>
                    </div>
                    
                    <div id="timeline-preview" class="preview-tab" style="display: none;">
                        <div class="timeline-visualization">
                            <!-- Timeline representation -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Loading Overlay -->
    <div id="loading-overlay" class="loading-overlay" style="display: none;">
        <div class="spinner"></div>
        <p>Loading...</p>
    </div>

    <!-- Success/Error Notifications -->
    <div id="notification-container" class="notification-container"></div>

    <!-- Hidden File Input for Import -->
    <input type="file" id="import-file" accept=".yml,.yaml" style="display: none;">

    <!-- Scripts -->
    <script src="js/yaml-generator.js"></script>
    <script src="js/pipeline-builder.js"></script>
    <script src="js/enhanced-pipeline-builder.js"></script>
    <script src="js/app.js"></script>
</body>
</html>